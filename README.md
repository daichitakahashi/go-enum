# go-enum

Idea from following video.  
[列挙型の作り方を再考する - Go Conference 2023 Online](https://youtu.be/TOUkp_Dxb9w)

This package provides support for defining `Visitor` and implementing `Accept()` methods.

## Usage
Examples [here](./example).

1. Prepare enum interface and member types.
```go
package fruits

import "github.com/daichitakahashi/go-enum"

type (
	// enum interface
	Fruits interface{}

	// member types
	Apple  enum.MemberOf[Fruits]
	Orange enum.MemberOf[Fruits]
	Grape  enum.MemberOf[Fruits]
)
```

2. Run following command.
```shell
$ go run github.com/daichitakahashi/go-enum/cmd/enumgen
```

3. Following code is generated with the file name `enum.gen.go`(file name is configurable).
```go
// Code generated by enumgen. DO NOT EDIT.

package fruits

type (
	FruitsVisitor interface {
		VisitApple(e Apple)
		VisitOrange(e Orange)
		VisitGrape(e Grape)
	}
	FruitsEnum interface {
		Accept(v FruitsVisitor)
	}
)

func (e Apple) Accept(v FruitsVisitor) {
	v.VisitApple(e)
}
func (e Orange) Accept(v FruitsVisitor) {
	v.VisitOrange(e)
}
func (e Grape) Accept(v FruitsVisitor) {
	v.VisitGrape(e)
}

var _ = []FruitsEnum{Apple{}, Orange{}, Grape{}}
```

4. Optional: Embed generated `FruitsEnum` type in `Fruits` type.

```go
type (
	// enum interface
	Fruits interface{
		FruitsEnum
	}
...
```

5. Implement your visitor type!

## Options for enumgen
|option|description|default value|
|---|---|---|
|`-wd`|working directory|`.`|
|`-out`|output file name|`enum.gen.go`|
